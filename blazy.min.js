/*!
  hey, [be]Lazy.js - v1.3.1 - 2015.02.01
  A lazy loading and multi-serving image script
  (c) Bjoern Klinggaard - @bklinggaard - http://dinbror.dk/blazy
*/
 function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.Blazy=t()}(this,function(){"use strict";function e(e){if(!document.querySelectorAll){var t=document.createStyleSheet();document.querySelectorAll=function(e,o,n,r,i){for(i=document.all,o=[],e=e.replace(/\[for\b/gi,"[htmlFor").split(","),n=e.length;n--;){for(t.addRule(e[n],"k:v"),r=i.length;r--;)i[r].currentStyle.k&&o.push(i[r]);t.removeRule(0)}return o}}A=!0,g=[],h={},w=e||{},w.imagesArr=w.imagesArr||[],w.allowUpdate=w.allowUpdate||!1,w.error=w.error||!1,w.offset=w.offset||100,w.success=w.success||!1,w.selector=w.selector||".b-lazy",w.separator=w.separator||"|",w.container=w.container?document.querySelectorAll(w.container):!1,w.errorClass=w.errorClass||"b-error",w.breakpoints=w.breakpoints||!1,w.successClass=w.successClass||"b-loaded",w.src=v=w.src||"data-src",w.loadInvisible=w.loadInvisible||!1,w.skipHorizontal=w.skipHorizontal||!1,b=window.devicePixelRatio>1,h.top=0-w.offset,h.left=0-w.offset,k=d(n,25),C=d(c,50),c(),f(w.breakpoints,function(e){return e.width>=window.screen.width?(v=e.src,!1):void 0}),o()}function t(){p?n():m||(m=!0,$(window).load(function(){n()}))}function o(){a(w.selector),A&&(A=!1,w.container&&f(w.container,function(e){l(e,"scroll",k)}),l(window,"resize",C),l(window,"resize",k),l(window,"scroll",k)),t()}function n(){for(var t=0;y>t;t++){var o=g[t];(i(o)||s(o))&&(e.prototype.load(o),g.splice(t,1),y--,t--)}w.allowUpdate||0!==y||e.prototype.destroy()}function r(e,t){if(t||w.loadInvisible||e.offsetWidth>0&&e.offsetHeight>0){var o=e.getAttribute(v)||e.getAttribute(w.src);if(o){var n=o.split(w.separator),r=n[b&&n.length>1?1:0],i=new Image;f(w.breakpoints,function(t){e.removeAttribute(t.src)}),e.removeAttribute(w.src),i.onerror=function(){w.error&&w.error(e,"invalid"),e.className=e.className+" "+w.errorClass},i.onload=function(){"img"===e.nodeName.toLowerCase()?e.src=r:e.style.backgroundImage='url("'+r+'")',e.className=e.className+" "+w.successClass,w.success&&w.success(e)},i.src=r}else w.error&&w.error(e,"missing"),e.className=e.className+" "+w.errorClass}}function i(e){var t=e.getBoundingClientRect();return(w.skipHorizontal||t.right>=h.left&&t.left<=h.right)&&t.bottom>=h.top&&t.top<=h.bottom}function s(e){return-1!==(" "+e.className+" ").indexOf(" "+w.successClass+" ")}function a(e){if(w.imagesArr.length>0)g=w.imagesArr,y=g.length;else{var t=document.querySelectorAll(e);y=t.length;for(var o=y;o--;g.unshift(t[o]));}}function c(){h.bottom=(window.innerHeight||document.documentElement.clientHeight)+w.offset,h.right=(window.innerWidth||document.documentElement.clientWidth)+w.offset}function l(e,t,o){e.attachEvent?e.attachEvent&&e.attachEvent("on"+t,o):e.addEventListener(t,o,!1)}function u(e,t,o){e.detachEvent?e.detachEvent&&e.detachEvent("on"+t,o):e.removeEventListener(t,o,!1)}function f(e,t){if(e&&t)for(var o=e.length,n=0;o>n&&t(e[n],n)!==!1;n++);}function d(e,t){var o=0;return function(){var n=+new Date;t>n-o||(o=n,e.apply(g,arguments))}}var p=!1,m=!1;$(window).load(function(){p=!0});var v,w,h,g,y,b,A,k,C;return e.prototype.revalidate=function(){o()},e.prototype.load=function(e,t){s(e)||r(e,t)},e.prototype.destroy=function(){w.container&&f(w.container,function(e){u(e,"scroll",k)}),u(window,"scroll",k),u(window,"resize",k),u(window,"resize",C),y=0,g.length=0,A=!0},e.prototype.updateImageList=function(e){w.allowUpdate&&(g.push(e),y++,t())},e.prototype.validate=function(){t()},e});